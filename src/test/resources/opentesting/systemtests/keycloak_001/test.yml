id: keycloak_001
testapi: '1.1'
active: true
description: rest test case
labels:
  - stage-local
  - department-mydepartment
  - function-myfunction
injections:
  - injectid: inject-rest-1
    cron: [ ]
    active: true
    service:
      type: rest
      connectstring: 'http://host.testcontainers.internal:50000/dummy/post'
      username: ''
      password: ''
      custom:
        - key: type
          value: POST
        - key: header
          value: source_rest_headers_1.json
        - key: senddelay
          value: 5000
    sourcefile: source_rest_1.json
    timetolive: 3m
    checks:
      - check-rest-1
checks:
  - checkid: check-rest-1
    active: true
    service:
      type: rest
      connectstring: 'http://host.testcontainers.internal:50000/dummy/jwtcheck'
      username: ''
      password: ''
      custom:
        - key: type
          value: GET
        - key: header
          value: check_rest_headers_1.json
        - key: jwtuser
          value: admin
        - key: jwtpassword
          value: admin
        - key: jwtparam
          value: 'client_id=admin-cli&grant_type=password&username=#jwtuser#&password=#jwtpassword#'
        - key: jwtpost
          value: 'http://host.testcontainers.internal:8080/realms/master/protocol/openid-connect/token'
        - key: jwtheader
          value: 'customkey=customvalue'
    validations:
      - order: 1
        request: ''
        response:
          - check_rest_1.json
        type: equals
    maxwaittime: 10s
    intervall: 5s
    mandatory: true
