package org.opentesting.services.file;

import org.opentesting.persistence.TestCaseFileRepository;
import org.opentesting.util.LogExecutionTime;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import lombok.extern.slf4j.Slf4j;

@Component
@Slf4j
public class FileManager {

    @Autowired
    private TestCaseFileRepository testCaseFileRepository;

    /**
     * store File
     */
    @LogExecutionTime
    public String storeFile(String testid, String filename, String content) {
        try {
            testCaseFileRepository.insert(testid, filename, content);
            return "File stored";
        } catch (Exception e) {
            log.error("could not store file", e);
            return e.getMessage();
        }
    } 
    
    /**
     * read File
     */
    @LogExecutionTime
    public String readFile(String testid, String filename) {
        try {
            return testCaseFileRepository.select(testid, filename);            
        } catch (Exception e) {
            log.error("could read stored file", e);
            return e.getMessage();
        }
    }
    
}