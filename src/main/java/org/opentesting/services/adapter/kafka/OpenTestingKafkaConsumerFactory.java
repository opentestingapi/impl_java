package org.opentesting.services.adapter.kafka;

import java.util.Map;
import java.util.Properties;

import org.apache.kafka.clients.consumer.Consumer;
import org.springframework.kafka.core.DefaultKafkaConsumerFactory;

import brave.internal.Nullable;
import brave.kafka.clients.KafkaTracing;

public class OpenTestingKafkaConsumerFactory extends DefaultKafkaConsumerFactory<String, String> {

    private KafkaTracing kafkaTracing;

    public OpenTestingKafkaConsumerFactory(Map<String, Object> configs, KafkaTracing kafkaTracing) {
        super(configs); 
        this.kafkaTracing = kafkaTracing; 
    }

    @Override
	public Consumer<String, String> createConsumer(@Nullable String groupId, @Nullable String clientIdPrefix,
			@Nullable String clientIdSuffix) {

		return kafkaTracing.consumer(createKafkaConsumer(groupId, clientIdPrefix, clientIdSuffix, null));
	}

	@Override
	public Consumer<String, String> createConsumer(@Nullable String groupId, @Nullable String clientIdPrefix,
			@Nullable final String clientIdSuffixArg, @Nullable Properties properties) {

		return kafkaTracing.consumer(createKafkaConsumer(groupId, clientIdPrefix, clientIdSuffixArg, properties));
	}
    
}