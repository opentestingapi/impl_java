package org.opentesting.util;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;

/**
 * dedicated class to transform yml to json
 */
public class MappingHelper {

    private MappingHelper() {}

    public static String jsonOrYmlToJson(String ymlOrJsonContent) throws JsonProcessingException {

        ObjectMapper jsonMapper = new ObjectMapper();
        try {
            // check, if its a valid JSON
            jsonMapper.readTree(ymlOrJsonContent);
            return ymlOrJsonContent;
        } catch (JsonProcessingException e) {
            // if it is no valid JSON, do we have YML?
            // if yes, create a JSON and process normal
            ObjectMapper yamlReader = new ObjectMapper(new YAMLFactory());

            JsonNode jsonNode = yamlReader.readTree(ymlOrJsonContent);
            return jsonMapper.writeValueAsString(jsonNode);
        }
    }

}
